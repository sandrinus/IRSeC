<AppLockerPolicy Version="1">
    <RuleCollection Type="Script">
        <FilePathRule Id="aece80d7-47c8-4a50-a3b1-5bbf1542db55" Name="Deny Unsigned Scripts" Description="Denies execution of unsigned scripts." UserOrGroupSid="S-1-1-0" Action="Deny">
            <Conditions>
                <FilePathCondition Path="*.ps1" />
                <FilePathCondition Path="*.bat" />
                <FilePathCondition Path="*.cmd" />
                <FilePathCondition Path="*.vbs" />
            </Conditions>
        </FilePathRule>
        <FilePathRule Id="3390cde6-8411-4383-896c-f20da8f66039" Name="Deny PowerShell for Non-Admins" Description="Prevents non-administrators from executing PowerShell scripts." UserOrGroupSid="S-1-1-0" Action="Deny">
            <Conditions>
                <FilePathCondition Path="C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" />
            </Conditions>
        </FilePathRule>
        <FilePathRule Id="633761c1-097b-48b0-bb30-791c0c0c93ac" Name="Allow Admin Scripts" Description="Allows members of the local Administrators group to run all scripts." UserOrGroupSid="S-1-5-32-544" Action="Allow">
            <Conditions>
                <FilePathCondition Path="*" />
            </Conditions>
        </FilePathRule>
        <FilePathRule Id="0e159112-0ce1-4d60-a58a-164485dfb592" Name="Deny Executables from Temp Folders" Description="Prevents execution of executables from temporary folders." UserOrGroupSid="S-1-1-0" Action="Deny">
            <Conditions>
                <FilePathCondition Path="%TEMP%\*" />
                <FilePathCondition Path="%TMP%\*" />
            </Conditions>
        </FilePathRule>
        <FilePathRule Id="85db0498-a6ab-4c60-a9e1-2691b0d74760" Name="Deny Scripts from User Folders" Description="Prevents execution of scripts from user folders." UserOrGroupSid="S-1-1-0" Action="Deny">
            <Conditions>
                <FilePathCondition Path="%USERPROFILE%\Downloads\*.ps1" />
                <FilePathCondition Path="%USERPROFILE%\Desktop\*.ps1" />
                <FilePathCondition Path="%USERPROFILE%\Documents\*.ps1" />
                <FilePathCondition Path="%USERPROFILE%\Downloads\*.bat" />
                <FilePathCondition Path="%USERPROFILE%\Desktop\*.bat" />
                <FilePathCondition Path="%USERPROFILE%\Documents\*.bat" />
            </Conditions>
        </FilePathRule>
        <FilePathRule Id="47a5a19b-cae7-4452-829e-11bbd3ae7b54" Name="Deny PowerShell Scripts for Standard Users" Description="Prevents standard users from executing PowerShell scripts." UserOrGroupSid="S-1-1-0" Action="Deny">
            <Conditions>
                <FilePathCondition Path="*.ps1" />
            </Conditions>
        </FilePathRule>
        <FilePathRule Id="e0cb3968-e9df-4086-a094-9a9cf1eff33c" Name="Deny Sensitive Operations for Non-Admins" Description="Prevents non-admins from accessing sensitive directories." UserOrGroupSid="S-1-1-0" Action="Deny">
            <Conditions>
                <FilePathCondition Path="C:\Windows\System32\*" />
                <FilePathCondition Path="C:\Program Files\*" />
                <FilePathCondition Path="C:\ProgramData\*" />
            </Conditions>
        </FilePathRule>
    </RuleCollection>
</AppLockerPolicy>
